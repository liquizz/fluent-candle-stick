<div class="container fade-in">
  <div class="page-header">
    <h1>Candlestick Data Viewer</h1>
  </div>

  <div class="card upload-card">
    <div class="card-header">
      <h2>Upload Data</h2>
    </div>
    <div class="card-body">
      <div class="upload-section">
        <div class="file-input-container">
          <label for="file-upload" class="file-label">
            @if (!file) {
              <span>Choose CSV File</span>
            } @else {
              <span class="file-name">{{ file.name }}</span>
            }
          </label>
          <input id="file-upload" type="file" (change)="onFileSelected($event)" accept=".csv" [disabled]="isLoading">
        </div>
        <button class="primary-button" (click)="uploadFile()" [disabled]="!file || isLoading">
          <span>{{ isLoading ? 'Processing...' : 'Upload CSV' }}</span>
        </button>
      </div>
      <div class="hint-text">
        <p>Upload a CSV file with candlestick data in the format: time, open, high, low, close, volume</p>
      </div>
      <div class="error-message" *ngIf="error">
        <span class="icon">‚ö†Ô∏è</span>
        <span>{{ error }}</span>
      </div>
    </div>
  </div>

  @if (isLoading) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Processing data...</p>
    </div>
  }

  @if (!hasData && !isLoading) {
    <div class="no-data-container">
      <div class="no-data-icon">üìä</div>
      <p>No data available.</p>
    </div>
  }

  <div class="chart-card card" *ngIf="hasData">
    <div class="card-header">
      <h2>Candlestick Chart</h2>
    </div>
    <div class="card-body">
      <app-candlestick-chart [data]="candleStickData"></app-candlestick-chart>
    </div>
  </div>

  <div class="table-card card" *ngIf="hasData">
    <div class="card-header">
      <h2>Price Data</h2>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>Time</th>
              <th>Open</th>
              <th>High</th>
              <th>Low</th>
              <th>Close</th>
              <th>Volume</th>
            </tr>
          </thead>
          <tbody>
            @for (candle of candleStickData; track candle.time) {
              <tr [class]="getRowClass(candle)">
                <td>{{ candle.time | date:'medium' }}</td>
                <td>{{ candle.open | number:'1.2-5' }}</td>
                <td>{{ candle.high | number:'1.2-5' }}</td>
                <td>{{ candle.low | number:'1.2-5' }}</td>
                <td>{{ candle.close | number:'1.2-5' }}</td>
                <td>{{ candle.volume | number:'1.2-5' }}</td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
